<!DOCTYPE html>
<html lang="tr" class="h-full bg-gray-100">
<head>
    <meta charset="UTF-8">
    <!-- Updated CSP to allow blob: for exports -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' blob:; script-src 'self' https://cdn.tailwindcss.com https://unpkg.com https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: https: blob:; font-src 'self' https:;">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accounting Ledger</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load PapaParse from local node_modules -->
    <script src="./node_modules/papaparse/papaparse.min.js"></script>
    
    <style>
        :root {
            --sidebar-bg: #111827; /* gray-900 */
            --sidebar-hover: #374151; /* gray-700 */
            --sidebar-active: #0ea5e9; /* sky-500 */
            --content-bg: #f9fafb; /* gray-50 */
            --card-bg: #ffffff;
            --text-primary: #1f2937; /* gray-800 */
            --text-secondary: #6b7280; /* gray-500 */
            --border-color: #e5e7eb; /* gray-200 */
            --accent: #0ea5e9; /* sky-500 */
            --accent-hover: #0284c7; /* sky-600 */
            --danger: #ef4444; /* red-500 */
            --danger-hover: #dc2626; /* red-600 */
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--content-bg);
            color: var(--text-primary);
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: var(--border-color);
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #9ca3af; /* gray-400 */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #6b7280; /* gray-500 */
        }

        /* Sidebar button styles */
        .tab-button {
            color: #d1d5db; /* gray-300 */
        }
        .tab-button:hover {
            background-color: var(--sidebar-hover);
            color: #ffffff;
        }
        .tab-button.active {
            background-color: var(--sidebar-active);
            color: #ffffff;
            font-weight: 600;
        }
        .tab-button svg {
            color: #9ca3af; /* gray-400 */
        }
        .tab-button.active svg {
            color: #ffffff;
        }

        /* Form elements */
        .form-input, .form-select {
            background-color: #ffffff;
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            border-radius: 0.375rem; /* rounded-md */
            padding: 0.5rem 0.75rem; /* py-2 px-3 */
            width: 100%;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 2px var(--accent);
        }

        .form-select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.5rem center;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-weight: 600;
            transition: background-color 0.2s, box-shadow 0.2s;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            cursor: pointer;
        }
        .btn:focus {
            outline: 2px solid transparent;
            outline-offset: 2px;
            box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.4);
        }
        .btn-primary {
            background-color: var(--accent);
            color: white;
        }
        .btn-primary:hover {
            background-color: var(--accent-hover);
        }
        .btn-danger {
            background-color: var(--danger);
            color: white;
        }
        .btn-danger:hover {
            background-color: var(--danger-hover);
        }
        .btn-secondary {
            background-color: #ffffff;
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }
        .btn-secondary:hover {
            background-color: #f9fafb; /* gray-50 */
        }
        .btn-success {
            background-color: #10b981; /* emerald-500 */
            color: white;
        }
        .btn-success:hover {
            background-color: #059669; /* emerald-600 */
        }
        
        /* Table */
        .data-table {
            width: 100%;
            border-collapse: collapse;
        }
        .data-table th, .data-table td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
            white-space: nowrap;
        }
        .data-table th {
            background-color: #f9fafb; /* gray-50 */
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            font-size: 0.75rem;
            user-select: none;
        }
        .data-table th.sortable {
            cursor: pointer;
        }
        .data-table th.sortable:hover {
            background-color: #e5e7eb;
        }
        .data-table tbody tr:hover {
            background-color: #f3f4f6; /* gray-100 */
        }

        /* Card */
        .card {
            background-color: var(--card-bg);
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
        }

        /* Sub-tabs within a page */
        .sub-tab-button {
            padding: 0.5rem 1rem;
            font-weight: 600;
            color: var(--text-secondary);
            border-bottom: 2px solid transparent;
            transition: color 0.2s, border-color 0.2s;
        }
        .sub-tab-button:hover {
            color: var(--text-primary);
        }
        .sub-tab-button.active {
            color: var(--accent);
            border-bottom-color: var(--accent);
        }
        .sub-tab-content {
            display: none;
        }
        .sub-tab-content.active {
            display: block;
        }
    </style>
</head>
<body class="h-full flex">

    <!-- Sidebar Navigation -->
    <nav class="w-64 h-full bg-gray-900 p-4 flex flex-col flex-shrink-0">
        <div class="flex items-center gap-3 px-2 mb-6">
            <svg id="icon-book" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-white h-8 w-8"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"></path></svg>
            <span class="text-xl font-bold text-white">Ledger App</span>
        </div>
        <ul class="flex flex-col gap-2">
            <li><button data-tab="dashboard" class="tab-button active w-full text-left flex items-center gap-3 px-3 py-2 rounded-md transition-colors">
                <svg id="icon-layout" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="3" rx="2"></rect><line x1="3" x2="21" y1="9" y2="9"></line><line x1="9" x2="9" y1="21" y2="9"></line></svg>
                Ana Menü
            </button></li>
            <li><button data-tab="newTransaction" class="tab-button w-full text-left flex items-center gap-3 px-3 py-2 rounded-md transition-colors">
                <svg id="icon-plus" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"></path><path d="M12 5v14"></path></svg>
                Yeni İşlem
            </button></li>
            <li><button data-tab="transactions" class="tab-button w-full text-left flex items-center gap-3 px-3 py-2 rounded-md transition-colors">
                <svg id="icon-search" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" x2="16.65" y1="21" y2="16.65"></line></svg>
                İşlemler
            </button></li>
            <li><button data-tab="customers" class="tab-button w-full text-left flex items-center gap-3 px-3 py-2 rounded-md transition-colors">
                <svg id="icon-users" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M22 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
                Müşteriler
            </button></li>
            <li><button data-tab="products" class="tab-button w-full text-left flex items-center gap-3 px-3 py-2 rounded-md transition-colors">
                <svg id="icon-package" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="16.5" x2="7.5" y1="9.4" y2="9.4"></line><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" x2="12" y1="22.08" y2="12"></line></svg>
                Ürünler
            </button></li>
            <li><button data-tab="import" class="tab-button w-full text-left flex items-center gap-3 px-3 py-2 rounded-md transition-colors">
                <svg id="icon-import" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3v12"></path><path d="m19 10-7 7-7-7"></path><path d="M3 17v2a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-2"></path></svg>
                Data Import
            </button></li>
        </ul>
    </nav>

    <!-- Main Content Area -->
    <main class="flex-1 h-full overflow-y-auto p-8">
        
        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content">
            <h1 class="text-3xl font-bold mb-6 text-gray-800">Ana Menü</h1>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6">
                <div class="card p-6">
                    <h2 class="text-sm font-medium text-gray-500 uppercase">Toplam İşlem</h2>
                    <p id="total-transactions" class="text-3xl font-bold mt-2 text-gray-800">0</p>
                </div>
                <div class="card p-6">
                    <h2 class="text-sm font-medium text-gray-500 uppercase">Toplam Veresiye</h2>
                    <p id="total-credit" class="text-3xl font-bold mt-2 text-red-600">0.00 TL</p>
                </div>
                <div class="card p-6">
                    <h2 class="text-sm font-medium text-gray-500 uppercase">Toplam Satış</h2>
                    <p id="total-sales" class="text-3xl font-bold mt-2 text-green-600">0.00 TL</p>
                </div>
                <div class="card p-6">
                    <h2 class="text-sm font-medium text-gray-500 uppercase">Net</h2>
                    <p id="net-balance" class="text-3xl font-bold mt-2 text-gray-800">0.00 TL</p>
                </div>
                <div class="card p-6">
                    <h2 class="text-sm font-medium text-gray-500 uppercase">Müşteriler</h2>
                    <p id="total-customers" class="text-3xl font-bold mt-2 text-gray-800">0</p>
                </div>
            </div>
            
            <div class="mt-8 card p-6">
                <h2 class="text-xl font-semibold mb-4 text-gray-800">Müşteri Bakiyesi</h2>
                <div class="max-h-96 overflow-y-auto">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Müşteri İsmi</th>
                                <th>Veresiye</th>
                                <th>Satış</th>
                                <th>Toplam Harcama</th>
                                <th>Durum</th>
                            </tr>
                        </thead>
                        <tbody id="customer-balances-table">
                            <!-- Rows will be injected by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- New Transaction Tab -->
        <div id="newTransaction" class="tab-content" style="display: none;">
            <h1 class="text-3xl font-bold mb-6 text-gray-800">Yeni İşlem</h1>

            <!-- Data Lists for autocomplete -->
            <datalist id="customer-list"></datalist>
            <datalist id="product-list"></datalist>

            <!-- Sub-tab navigation -->
            <div class="border-b border-gray-200 mb-6">
                <nav class="-mb-px flex gap-6" aria-label="Tabs">
                    <button data-subtab="sale" class="sub-tab-button active">
                        Ürün Satışı
                    </button>
                    <button data-subtab="payment" class="sub-tab-button">
                        Ödeme Al
                    </button>
                </nav>
            </div>

            <!-- Sub-tab content for Product Sale -->
            <div id="subtab-sale" class="sub-tab-content active">
                <form id="transaction-form" class="max-w-2xl grid grid-cols-1 md:grid-cols-2 gap-6 card p-6">
                    <div>
                        <label for="t-date" class="block text-sm font-medium text-gray-700 mb-1">Tarih</label>
                        <input type="date" id="t-date" class="form-input" required>
                    </div>
                    <div>
                        <label for="t-type" class="block text-sm font-medium text-gray-700 mb-1">Ödeme Yöntemi</label>
                        <select id="t-type" class="form-select" required>
                            <option value="VERESİYE">VERESİYE</option>
                            <option value="SATIŞ">SATIŞ</option>
                            <option value="İADE">İADE</option>
                            <option value="İKİSİDE">İKİSİDE</option>
                        </select>
                    </div>
                    
                    <div class="md:col-span-2">
                        <label for="t-customer" class="block text-sm font-medium text-gray-700 mb-1">Müşteri İsmi</label>
                        <input type="text" id="t-customer" class="form-input" list="customer-list" placeholder="Start typing..." required>
                    </div>

                    <div class="md:col-span-2">
                        <label for="t-product-name" class="block text-sm font-medium text-gray-700 mb-1">Ürün Çeşidi</label>
                        <input type="text" id="t-product-name" class="form-input" list="product-list" placeholder="Start typing...">
                    </div>
                    <div>
                        <label for="t-quantity" class="block text-sm font-medium text-gray-700 mb-1">Miktar</label>
                        <input type="number" id="t-quantity" class="form-input" min="0" step="any" value="1">
                    </div>
                    <div>
                        <label for="t-unit" class="block text-sm font-medium text-gray-700 mb-1">Birim</label>
                        <select id="t-unit" class="form-select">
                            <option value="TANE">TANE</option>
                            <option value="ÇUVAL">ÇUVAL</option>
                            <option value="KİLOGRAM">KİLOGRAM</option>
                            <option value="KOVAN">KOVAN</option>
                            <option value="TORBA">TORBA</option>
                            <option value="PAKET">PAKET</option>
                            <option value="TON">TON</option>
                        </select>
                    </div>

                    <div>
                        <label for="t-product-type" class="block text-sm font-medium text-gray-700 mb-1">Ürün Çeşidi</label>
                        <select id="t-product-type" class="form-select">
                            <option value="İLAÇ">İLAÇ</option>
                            <option value="GÜBRE">GÜBRE</option>
                            <option value="KÖMÜR">KÖMÜR</option>
                            <option value="TOHUM">TOHUM</option>
                            <option value="FİDE">FİDE</option>
                            <option value="ARI">ARI</option>
                            <option value="DİĞER">DİĞER</option>
                        </select>
                    </div>

                    <div>
                        <label for="t-price" class="block text-sm font-medium text-gray-700 mb-1">Birim Fiyat</label>
                        <input type="number" id="t-price" class="form-input" min="0" step="any" placeholder="Auto-fills from product">
                    </div>
                    <div>
                        <label for="t-total" class="block text-sm font-medium text-gray-700 mb-1">Toplam Fiyat</label>
                        <input type="text" id="t-total" class="form-input bg-gray-100" placeholder="0.00 TL" readonly>
                    </div>
                    <div class="md:col-span-2 flex justify-end gap-4">
                        <button type="button" class="btn btn-secondary" id="clear-form-btn">Temizle</button>
                        <button type="submit" class="btn btn-primary">
                            <svg id="icon-save" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path><polyline points="17 21 17 13 7 13 7 21"></polyline><polyline points="7 3 7 8 15 8"></polyline></svg>
                            Satışı Kaydet
                        </button>
                    </div>
                </form>
            </div>

            <!-- Sub-tab content for Payment -->
            <div id="subtab-payment" class="sub-tab-content">
                <form id="payment-form" class="max-w-2xl grid grid-cols-1 md:grid-cols-2 gap-6 card p-6">
                    <div>
                        <label for="p-date" class="block text-sm font-medium text-gray-700 mb-1">Tarih</label>
                        <input type="date" id="p-date" class="form-input" required>
                    </div>
                    <div class="md:col-span-2">
                        <label for="p-customer" class="block text-sm font-medium text-gray-700 mb-1">Müşteri İsmi</label>
                        <input type="text" id="p-customer" class="form-input" list="customer-list" placeholder="Müşteri seç..." required>
                    </div>
                    <div>
                        <label for="p-amount" class="block text-sm font-medium text-gray-700 mb-1">Ödeme Miktarı</label>
                        <input type="number" id="p-amount" class="form-input" min="0" step="any" placeholder="0.00" required>
                    </div>
                    <div class="md:col-span-2 flex justify-end gap-4">
                        <button type="button" class="btn btn-secondary" id="clear-payment-form-btn">Temizle</button>
                        <button type="submit" class="btn btn-primary">
                            <svg id="icon-dollar-sign" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" x2="12" y1="2" y2="22"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg>
                            Ödemeyi Kaydet
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Search Transactions Tab -->
        <div id="transactions" class="tab-content" style="display: none;">
            <div class="flex justify-between items-center mb-6">
                <h1 class="text-3xl font-bold text-gray-800">İşlemler</h1>
                <button id="export-transactions-btn" class="btn btn-success">
                    <svg id="icon-download" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" x2="12" y1="15" y2="3"></line></svg>
                    Excel/CSV'ye Aktar
                </button>
            </div>
            
            <!-- Filter Controls -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6 card p-4">
                <div>
                    <label for="f-customer" class="block text-sm font-medium text-gray-700 mb-1">Müşteri</label>
                    <input type="text" id="f-customer" class="form-input" placeholder="Search by name...">
                </div>
                <div>
                    <label for="f-type" class="block text-sm font-medium text-gray-700 mb-1">Yöntem</label>
                    <select id="f-type" class="form-select">
                        <option value="">Hepsi</option>
                        <option value="VERESİYE">VERESİYE</option>
                        <option value="SATIŞ">SATIŞ</option>
                        <option value="ÖDEME">ÖDEME</option>
                        <option value="İADE">İADE</option>
                        <option value="İKİSİDE">İKİSİDE</option>
                    </select>
                </div>
                <div>
                    <label for="f-product-type" class="block text-sm font-medium text-gray-700 mb-1">Ürün Çeşidi</label>
                    <select id="f-product-type" class="form-select">
                        <option value="">Hepsi</option>
                        <option value="İLAÇ">İLAÇ</option>
                        <option value="GÜBRE">GÜBRE</option>
                        <option value="KÖMÜR">KÖMÜR</option>
                        <option value="TOHUM">TOHUM</option>
                        <option value="FİDE">FİDE</option>
                        <option value="ARI">ARI</option>
                        <option value="DİĞER">DİĞER</option>
                    </select>
                </div>
                <div class="flex items-end gap-2">
                    <button id="filter-btn" class="btn btn-primary w-full">Ara</button>
                    <button id="reset-filter-btn" class="btn btn-secondary w-full">Sıfırla</button>
                </div>
            </div>

            <!-- Transaction Table -->
            <div class="card overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Tarih</th>
                                <th>Müşteri</th>
                                <th>Ödeme Yöntemi</th>
                                <th>Ürün Çeşidi</th>
                                <th>Ürün Adı</th>
                                <th>Miktar</th>
                                <th>Birim</th>
                                <th>Fiyat</th>
                                <th>Toplam</th>
                                <th>İşlemler</th>
                            </tr>
                        </thead>
                        <tbody id="transaction-table-body">
                            <!-- Rows will be injected by JS -->
                        </tbody>
                    </table>
                </div>
                <div id="no-transactions" class="text-center p-8 text-gray-500" style="display: none;">
                    No transactions found.
                </div>
            </div>
        </div>

        <!-- Customers Tab -->
        <div id="customers" class="tab-content" style="display: none;">
            <div class="flex justify-between items-center mb-6">
                <h1 class="text-3xl font-bold text-gray-800">Müşteriler</h1>
                <button id="export-customers-btn" class="btn btn-success">
                    <svg id="icon-download" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" x2="12" y1="15" y2="3"></line></svg>
                    Excel/CSV'ye Aktar
                </button>
            </div>

            <!-- Add Customer Form (Updated) -->
            <form id="customer-form" class="mb-6 card p-6">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                    <div>
                        <label for="c-name" class="block text-sm font-medium text-gray-700 mb-1">Müşteri İsmi</label>
                        <input type="text" id="c-name" class="form-input" placeholder="Ad Soyad" required>
                    </div>
                    <div>
                        <label for="c-id" class="block text-sm font-medium text-gray-700 mb-1">TC No</label>
                        <input type="text" id="c-id" class="form-input" placeholder="TC No" pattern="\d{11}" maxlength="11">
                    </div>
                     <div>
                        <label for="c-dob" class="block text-sm font-medium text-gray-700 mb-1">Doğum Tarihi</label>
                        <input type="date" id="c-dob" class="form-input">
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                    <div>
                         <label for="c-city" class="block text-sm font-medium text-gray-700 mb-1">İl</label>
                         <input type="text" id="c-city" class="form-input" placeholder="İl">
                    </div>
                    <div>
                         <label for="c-district" class="block text-sm font-medium text-gray-700 mb-1">İlçe</label>
                         <input type="text" id="c-district" class="form-input" placeholder="İlçe">
                    </div>
                    <div>
                         <label for="c-phone" class="block text-sm font-medium text-gray-700 mb-1">Telefon</label>
                         <input type="tel" id="c-phone" class="form-input" placeholder="Telefon Nuamrası">
                    </div>
                </div>
                <div class="mb-4">
                    <label for="c-street" class="block text-sm font-medium text-gray-700 mb-1">Mahalle / Sokak / Cadde</label>
                    <input type="text" id="c-street" class="form-input" placeholder="Açık adres">
                </div>
                <div class="flex justify-end">
                    <button type="submit" class="btn btn-primary w-full md:w-auto">
                        <svg id="icon-user-plus" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><line x1="19" x2="19" y1="8" y2="14"></line><line x1="22" x2="16" y1="11" y2="11"></line></svg>
                        Müşteri Ekle
                    </button>
                </div>
            </form>
            
            <!-- Customer List -->
            <div class="card overflow-hidden">
                 <div class="overflow-x-auto">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th class="sortable" data-sort="name">İsim ↕</th>
                                <th class="sortable" data-sort="tc">TC No ↕</th>
                                <th class="sortable" data-sort="dob">Doğum T. ↕</th>
                                <th>Telefon</th>
                                <th class="sortable" data-sort="address">Adres ↕</th>
                                <th>İşlemler</th>
                            </tr>
                        </thead>
                        <tbody id="customer-table-body">
                            <!-- Rows will be injected by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Products Tab -->
        <div id="products" class="tab-content" style="display: none;">
            <div class="flex justify-between items-center mb-6">
                <h1 class="text-3xl font-bold text-gray-800">Ürünleri Yönet</h1>
                <button id="export-products-btn" class="btn btn-success">
                    <svg id="icon-download" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" x2="12" y1="15" y2="3"></line></svg>
                    Excel/CSV'ye Aktar
                </button>
            </div>

            <!-- Add Product Form -->
            <form id="product-form" class="mb-6 grid grid-cols-1 md:grid-cols-4 gap-4 card p-6">
                <div>
                    <label for="p-name" class="block text-sm font-medium text-gray-700 mb-1">Ürün İsmi</label>
                    <input type="text" id="p-name" class="form-input" placeholder="Product Name" required>
                </div>
                 <div>
                    <label for="p-type" class="block text-sm font-medium text-gray-700 mb-1">Ürün Çeşidi</label>
                    <select id="p-type" class="form-select">
                        <option value="İLAÇ">İLAÇ</option>
                        <option value="GÜBRE">GÜBRE</option>
                        <option value="DİĞER">DİĞER</option>
                    </select>
                </div>
                <div>
                    <label for="p-unit" class="block text-sm font-medium text-gray-700 mb-1">Birim</label>
                    <select id="p-unit" class="form-select">
                        <option value="TANE">TANE</option>
                        <option value="ÇUVAL">ÇUVAL</option>
                        <option value="KİLOGRAM">KİLOGRAM</option>
                        <option value="KOVAN">KOVAN</option>
                        <option value="TORBA">TORBA</option>
                        <option value="PAKET">PAKET</option>
                        <option value="TON">TON</option>
                    </select>
                </div>

                <div>
                    <label for="p-price" class="block text-sm font-medium text-gray-700 mb-1">Fiyat</label>
                    <input type="number" id="p-price" class="form-input" min="0" step="any" placeholder="0.00" required>
                </div>
                <div class="flex items-end">
                    <button type="submit" class="btn btn-primary w-full">
                         <svg id="icon-package-plus" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 16h6"></path><path d="M19 13v6"></path><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14"></path><path d="m7.5 4.6-1-1.16"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" x2="12" y1="22.08" y2="12"></line></svg>
                        Ürün Ekle
                    </button>
                </div>
            </form>
            
            <!-- Product List -->
            <div class="card overflow-hidden">
                 <div class="overflow-x-auto">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>İsim</th>
                                <th>Çeşit</th>
                                <th>Birim</th>
                                <th>Fiyat</th>
                                <th>Stok</th>
                                <th>İşlemler</th>
                            </tr>
                        </thead>
                        <tbody id="product-table-body">
                            <!-- Rows will be injected by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Data Import Tab -->
        <div id="import" class="tab-content" style="display: none;">
            <h1 class="text-3xl font-bold mb-6 text-gray-800">Data Import</h1>
            <div class="card p-6">
                <p class="text-gray-600 mb-4">
                    To get started, please copy and paste your data from your CSV files into the text boxes below.
                    This only needs to be done once. The data will be saved to JSON files on your computer.
                </p>
                
                <div class="mb-4">
                    <label for="import-transactions" class="block text-sm font-medium text-gray-700 mb-2">1. Transactions (from 'ANA SAYFA.csv')</label>
                    <textarea id="import-transactions" rows="8" class="form-input" placeholder="TARİH,ADI SOYADI,VERESİYE/SATIŞ,MALIN CİNSİ,ÇEŞİT,MİKTAR,ADET&#10;2025-01-16,ERDAL UYSAL,VERESİYE,İLAÇ,Stomp® Aqua,1,TANE&#10;..."></textarea>
                </div>

                <div class="mb-4">
                    <label for="import-products" class="block text-sm font-medium text-gray-700 mb-2">2. Products (from 'İLAÇ FİYATLARI.csv' and 'GÜBRE FİYATLARI.csv')</label>
                    <textarea id="import-products" rows="8" class="form-input" placeholder="ÜRÜN ADI,FİYAT&#10;ABG MEK 1.8 EC LT001,750&#10;ACTIWAVE - 10 Lt ,5000&#10;..."></textarea>
                </div>
                
                <button id="import-btn" class="btn btn-primary">
                    <svg id="icon-database" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><ellipse cx="12" cy="5" rx="9" ry="3"></ellipse><path d="M3 5v14a9 3 0 0 0 18 0V5"></path><path d="M3 12a9 3 0 0 0 18 0"></path></svg>
                    Import and Save Data
                </button>
            </div>
        </div>

    </main>

    <!-- Global Alert/Toast -->
    <div id="toast" class="fixed bottom-8 right-8 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg transform translate-x-full transition-transform duration-300 ease-out">
        <span id="toast-message"></span>
    </div>

    <!-- Edit Product Modal -->
    <div id="edit-product-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50" style="display: none;">
        <div class="card p-6 w-full max-w-md">
            <h2 class="text-2xl font-bold mb-4">Ürünü Editle</h2>
            <form id="edit-product-form">
                <input type="hidden" id="edit-p-id">
                <div class="mb-4">
                    <label for="edit-p-name" class="block text-sm font-medium text-gray-700 mb-1">Product Name</label>
                    <input type="text" id="edit-p-name" class="form-input" required>
                </div>
                <div class="mb-4">
                    <label for="edit-p-type" class="block text-sm font-medium text-gray-700 mb-1">Product Type</label>
                    <select id="edit-p-type" class="form-select" required>
                        <option value="İLAÇ">İLAÇ</option>
                        <option value="GÜBRE">GÜBRE</option>
                        <option value="DİĞER">DİĞER</option>
                    </select>
                </div>

                <div class="mb-4">
                    <label for="edit-p-unit" class="block text-sm font-medium text-gray-700 mb-1">Birim</label>
                    <select id="edit-p-unit" class="form-select">
                        <option value="TANE">TANE</option>
                        <option value="ÇUVAL">ÇUVAL</option>
                        <option value="KİLOGRAM">KİLOGRAM</option>
                        <option value="KOVAN">KOVAN</option>
                        <option value="TORBA">TORBA</option>
                        <option value="PAKET">PAKET</option>
                        <option value="TON">TON</option>
                    </select>
                </div>

                <div class="mb-4">
                    <label for="edit-p-price" class="block text-sm font-medium text-gray-700 mb-1">Fiyat</label>
                    <input type="number" id="edit-p-price" class="form-input" min="0" step="any" required>
                </div>
                <div class="flex justify-end gap-4">
                    <button type="button" id="cancel-edit-btn" class="btn btn-secondary">İptal</button>
                    <button type="submit" class="btn btn-primary">Değişiklikleri Kaydet</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Stock Modal -->
    <div id="add-stock-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50" style="display: none;">
        <div class="card p-6 w-full max-w-sm">
            <h2 class="text-2xl font-bold mb-4">Stok Ekle</h2>
            <p id="add-stock-product-name" class="text-gray-600 mb-4"></p>
            <form id="add-stock-form">
                <input type="hidden" id="add-stock-id">
                <div class="mb-4">
                    <label for="add-stock-quantity" class="block text-sm font-medium text-gray-700 mb-1">Eklenecek Miktar</label>
                    <input type="number" id="add-stock-quantity" class="form-input" min="0" step="any" required>
                </div>
                <div class="flex justify-end gap-4">
                    <button type="button" id="cancel-stock-btn" class="btn btn-secondary">İptal</button>
                    <button type="submit" class="btn btn-primary">Kaydet</button>
                </div>
            </form>
        </div>
    </div>

    <script src="./renderer.js" defer></script>
</body>
</html>